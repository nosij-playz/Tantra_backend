<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Department Dashboard - {{ department_name or department_id }}</title>
    <link rel="stylesheet" href="/static/css/admin.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  </head>
  <body>
    <div class="container floating">
      <div class="header">
        <div class="brand">
          <div class="logo pulse">T</div>
          <div>
            <h1>{{ department_name or department_id }}</h1>
            <div class="small">Department Dashboard</div>
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:12px;">
          <a href="{{ url_for('participants_list', dept_id=department_id) }}" class="btn btn-ghost"><i class="fas fa-users"></i> View Participants</a>
          <a href="{{ url_for('logout') }}" class="btn btn-ghost"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </div>
      </div>
      <div class="stats">
        <div class="stat">
          <h3><i class="fas fa-users"></i> Total Participants</h3>
          <p>{{ total_participants or 0 }}</p>
        </div>
        <div class="stat">
          <h3><i class="fas fa-user-check"></i> Unique Participants</h3>
          <p>{{ unique_count or 0 }}</p>
        </div>
      </div>
      <div class="card">
        <h2 style="margin:0 0 20px 0;display:flex;align-items:center;gap:10px;">
          <i class="fas fa-calendar-alt"></i> Department Events
        </h2>
        <div class="table-wrap">
          <div class="recent-list">
            {% for e in events_info %}
              <div class="recent-event-card">
                <div style="display:flex;justify-content:space-between;gap:12px;align-items:flex-start;">
                  <div style="flex:1;min-width:0;">
                    <div style="display:flex;align-items:center;gap:10px;">
                      <i class="fas fa-calendar-check" style="color:var(--accent);"></i>
                      <div style="min-width:0;">
                        <div class="recent-title" style="font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">{{ e.name }}</div>
                      </div>
                    </div>
                  </div>
                  <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px;">
                    <div>
                      {% if e.status == 1 %}
                        <span class="badge" style="background:linear-gradient(135deg, var(--success), #00c853);color:#001"><i class="fas fa-check-circle"></i> Open</span>
                      {% else %}
                        <span class="badge" style="background:linear-gradient(135deg, var(--danger), #ff2b55);"><i class="fas fa-times-circle"></i> Closed</span>
                      {% endif %}
                    </div>
                    <div style="color:var(--muted);font-size:13px">Participants: <strong>{{ e.participant_count }}</strong></div>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </body>
</html>